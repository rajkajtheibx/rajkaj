

<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>‡§ú‡§®‡§™‡•ç‡§∞‡§§‡§ø‡§®‡§ø‡§ß‡§ø ‡§∞‡§æ‡§ú‡§ï‡§æ‡§ú | ‡§≠‡§æ‡§∞‡§§ ‡§ï‡•á ‡§≤‡•ã‡§ï‡§§‡§Ç‡§§‡•ç‡§∞ ‡§ï‡•á ‡§ï‡§∞‡•ç‡§£‡§ß‡§æ‡§∞</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.css" />
  <style>
    body { font-family: sans-serif; margin: 0; background: #f4f4f4; }
    header { background: #004080; color: white; padding: 1em; text-align: center; }
    .swiper { width: 100%; height: auto; }
    .swiper-slide img { width: 100%; height: auto; object-fit: cover; }
    .filters {
      padding: 1em;
      display: flex;
      flex-wrap: wrap;
      gap: 1em;
      justify-content: center;
      background: #fff;
    }
    .filters select { padding: 0.5em; font-size: 1em; }
    .grid {
      display: flex;
      flex-wrap: wrap;
      padding: 1em;
      gap: 1em;
      justify-content: center;
    }
    .card {
      width: 22%;
      padding: 1em;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      transition: 0.3s;
      position: relative;
    }
    .card:hover { transform: scale(1.02); }
    .card img { width: 100%; border-radius: 4px; height: 200px; object-fit: cover; }
    .social a, .actions button {
      margin-right: 0.5em;
      text-decoration: none;
      font-size: 0.9em;
    }
    .actions { margin-top: 0.5em; }
    .actions button {
      background: none;
      border: none;
      cursor: pointer;
      font-size: 1.2em;
    }
    @media (max-width: 768px) {
      .grid {
        overflow-x: auto;
        flex-wrap: nowrap;
        justify-content: flex-start;
        scroll-snap-type: x mandatory;
      }
      .card {
        flex: 0 0 90%;
        scroll-snap-align: start;
      }
    }
  </style>
</head>
<body>
<header>
  <h1>‡§ú‡§®‡§™‡•ç‡§∞‡§§‡§ø‡§®‡§ø‡§ß‡§ø ‡§∞‡§æ‡§ú‡§ï‡§æ‡§ú</h1>
  <p>‡§≠‡§æ‡§∞‡§§ ‡§ï‡•á ‡§≤‡•ã‡§ï‡§§‡§Ç‡§§‡•ç‡§∞ ‡§ï‡•á ‡§ï‡§∞‡•ç‡§£‡§ß‡§æ‡§∞</p>
</header>

<div class="swiper">
  <div class="swiper-wrapper">
    <div class="swiper-slide">
      <img src="https://firebasestorage.googleapis.com/v0/b/rajkajtheibx.firebasestorage.app/o/Banner%20Image.jpg?alt=media&token=3e5bab12-d249-418d-b7dd-4095fa7d6dc8" />
    </div>
    <div class="swiper-slide">
      <img src="https://firebasestorage.googleapis.com/v0/b/rajkajtheibx.firebasestorage.app/o/Banner%20Image%202%20.jpg?alt=media&token=8685ec16-300d-47f3-b48b-d8262ebfee8e" />
    </div>
  </div>
</div>

<div class="filters">
  <select id="stateFilter"><option value="">‡§∞‡§æ‡§ú‡•ç‡§Ø ‡§ö‡•Å‡§®‡•á‡§Ç</option></select>
  <select id="districtFilter"><option value="">‡§ú‡§ø‡§≤‡§æ ‡§ö‡•Å‡§®‡•á‡§Ç</option></select>
  <select id="blockFilter"><option value="">‡§¨‡•ç‡§≤‡•â‡§ï ‡§ö‡•Å‡§®‡•á‡§Ç</option></select>
  <select id="designationFilter"><option value="">‡§™‡§¶ ‡§ö‡•Å‡§®‡•á‡§Ç</option></select>
  <select id="periodFilter"><option value="">‡§Ö‡§µ‡§ß‡§ø ‡§ö‡•Å‡§®‡•á‡§Ç</option></select>
</div>

<div class="grid" id="cardGrid">Loading...</div>

<script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script>
const cardColors = [
  '#FFF8E1','#E1F5FE','#F1F8E9','#FBE9E7','#EDE7F6',
  '#E8F5E9','#FFF3E0','#F3E5F5','#E0F7FA','#FFEBEE',
  '#E0F2F1','#FFFDE7'
];
let data = [];
fetch('sample-data.csv')
  .then(res => res.text())
  .then(csv => {
    const lines = csv.split('\n').slice(1);
    data = lines.map(line => {
      const [name, designation, period, state, district, block, village, education, image, fb, twitter, whatsapp, blog] = line.split(',');
      return { name, designation, period, state, district, block, village, education, image, fb, twitter, whatsapp, blog };
    });
    populateFilters();
    renderCards(data);
  });

function populateFilters() {
  const stateSet = new Set(), designationSet = new Set(), periodSet = new Set();
  data.forEach(d => {
    if (d.state) stateSet.add(d.state);
    if (d.designation) designationSet.add(d.designation);
    if (d.period) periodSet.add(d.period);
  });
  fillSelect('stateFilter', stateSet);
  fillSelect('designationFilter', designationSet);
  fillSelect('periodFilter', periodSet);

  document.getElementById('stateFilter').addEventListener('change', () => {
    const selectedState = document.getElementById('stateFilter').value;
    const districts = new Set(data.filter(d => d.state === selectedState).map(d => d.district));
    fillSelect('districtFilter', districts, true);
    document.getElementById('districtFilter').dispatchEvent(new Event('change'));
  });

  document.getElementById('districtFilter').addEventListener('change', () => {
    const selectedState = document.getElementById('stateFilter').value;
    const selectedDistrict = document.getElementById('districtFilter').value;
    const blocks = new Set(data.filter(d => d.state === selectedState && d.district === selectedDistrict).map(d => d.block));
    fillSelect('blockFilter', blocks, true);
  });
}

function fillSelect(id, set, reset = false) {
  const select = document.getElementById(id);
  if (reset) select.innerHTML = `<option value="">${select.options[0].text}</option>`;
  set.forEach(val => {
    const opt = document.createElement('option');
    opt.value = val;
    opt.textContent = val;
    select.appendChild(opt);
  });
  select.addEventListener('change', filterData);
}

function filterData() {
  const state = document.getElementById('stateFilter').value;
  const district = document.getElementById('districtFilter').value;
  const block = document.getElementById('blockFilter').value;
  const designation = document.getElementById('designationFilter').value;
  const period = document.getElementById('periodFilter').value;
  const filtered = data.filter(d =>
    (!state || d.state === state) &&
    (!district || d.district === district) &&
    (!block || d.block === block) &&
    (!designation || d.designation === designation) &&
    (!period || d.period === period)
  );
  renderCards(filtered);
}

function downloadCard(card, name) {
  html2canvas(card, { useCORS: true }).then(canvas => {
    const link = document.createElement('a');
    link.download = name + '.png';
    link.href = canvas.toDataURL();
    link.click();
  });
}

function shareCard(name) {
  if (navigator.share) {
    navigator.share({
      title: '‡§ú‡§®‡§™‡•ç‡§∞‡§§‡§ø‡§®‡§ø‡§ß‡§ø ‡§ï‡§æ‡§∞‡•ç‡§°',
      text: `‡§ú‡§®‡§™‡•ç‡§∞‡§§‡§ø‡§®‡§ø‡§ß‡§ø: ${name}`,
      url: window.location.href
    });
  } else {
    alert("Sharing not supported on this browser.");
  }
}

function renderCards(dataset) {
  const grid = document.getElementById('cardGrid');
  grid.innerHTML = '';
  if (dataset.length === 0) return grid.innerHTML = '<p>No results found.</p>';
  dataset.forEach((d, i) => {
    const card = document.createElement('div');
    card.className = 'card';
    card.style.backgroundColor = cardColors[i % cardColors.length];

    const image = document.createElement('img');
    image.src = d.image || 'https://via.placeholder.com/300x200?text=No+Image';
    image.alt = d.name;
    image.crossOrigin = "anonymous";

    const socialLinks = `
      ${d.fb ? `<a href="${d.fb}" target="_blank">FB</a>` : ''}
      ${d.twitter ? `<a href="${d.twitter}" target="_blank">Twitter</a>` : ''}
      ${d.whatsapp ? `<a href="https://wa.me/${d.whatsapp}" target="_blank">WA</a>` : ''}
      ${d.blog ? `<a href="${d.blog}" target="_blank">Blog</a>` : ''}
    `;

    card.innerHTML = `
      <h3>${d.name}</h3>
      <p><strong>‡§™‡§¶:</strong> ${d.designation}</p>
      <p><strong>‡§ó‡§æ‡§Ç‡§µ:</strong> ${d.village}</p>
      <p><strong>‡§∂‡§ø‡§ï‡•ç‡§∑‡§æ:</strong> ${d.education}</p>
      <div class="social">${socialLinks}</div>
      <div class="actions">
        <button onclick="downloadCard(this.closest('.card'), '${d.name}')">‚¨á</button>
        <button onclick="shareCard('${d.name}')">üì§ Share</button>
      </div>`;

    card.prepend(image);
    grid.appendChild(card);
  });
}

new Swiper('.swiper', { loop: true, autoplay: { delay: 4000 } });
</script>
</body>
</html>
